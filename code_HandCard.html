<html><head>
<link rel="stylesheet" href="style.css" type="text/css">
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type">
<link rel="Start" href="index.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="HelloWrong" rel="Chapter" href="HelloWrong.html">
<link title="HelloRight" rel="Chapter" href="HelloRight.html">
<link title="HelloCommand" rel="Chapter" href="HelloCommand.html">
<link title="Basics" rel="Chapter" href="Basics.html">
<link title="Choices" rel="Chapter" href="Choices.html">
<link title="Pipes" rel="Chapter" href="Pipes.html">
<link title="Ivars" rel="Chapter" href="Ivars.html">
<link title="MoreChoices" rel="Chapter" href="MoreChoices.html">
<link title="MorePipes" rel="Chapter" href="MorePipes.html">
<link title="StdinLine" rel="Chapter" href="StdinLine.html">
<link title="StdoutLine" rel="Chapter" href="StdoutLine.html">
<link title="StdinAll" rel="Chapter" href="StdinAll.html">
<link title="WriteString" rel="Chapter" href="WriteString.html">
<link title="WriteLine" rel="Chapter" href="WriteLine.html">
<link title="WriteWith" rel="Chapter" href="WriteWith.html">
<link title="Diary" rel="Chapter" href="Diary.html">
<link title="Cat" rel="Chapter" href="Cat.html">
<link title="PrintServer" rel="Chapter" href="PrintServer.html">
<link title="EchoOnceServer" rel="Chapter" href="EchoOnceServer.html">
<link title="EchoServer" rel="Chapter" href="EchoServer.html">
<link title="ExitEchoServer" rel="Chapter" href="ExitEchoServer.html">
<link title="PrintClient" rel="Chapter" href="PrintClient.html">
<link title="EchoClient" rel="Chapter" href="EchoClient.html">
<link title="TcpShell" rel="Chapter" href="TcpShell.html">
<link title="KeyValueStore" rel="Chapter" href="KeyValueStore.html">
<link title="RedisOp" rel="Chapter" href="RedisOp.html">
<link title="Redis" rel="Chapter" href="Redis.html">
<link title="HandCard" rel="Chapter" href="HandCard.html">
<link title="SexpCard" rel="Chapter" href="SexpCard.html">
<link title="MarshalCard" rel="Chapter" href="MarshalCard.html">
<link title="BinioCard" rel="Chapter" href="BinioCard.html">
<link title="ArithMarshal" rel="Chapter" href="ArithMarshal.html">
<link title="MarshalClient" rel="Chapter" href="MarshalClient.html">
<link title="MarshalServer" rel="Chapter" href="MarshalServer.html">
<link title="ArithSexp" rel="Chapter" href="ArithSexp.html">
<link title="SexpClient" rel="Chapter" href="SexpClient.html">
<link title="SexpServer" rel="Chapter" href="SexpServer.html">
<link title="ToStringProtocol" rel="Chapter" href="ToStringProtocol.html">
<link title="ToStringClient" rel="Chapter" href="ToStringClient.html">
<link title="ToStringServer" rel="Chapter" href="ToStringServer.html">
<link title="ArithRpc" rel="Chapter" href="ArithRpc.html">
<link title="RpcClient" rel="Chapter" href="RpcClient.html">
<link title="RpcServer" rel="Chapter" href="RpcServer.html">
<link title="Ephemeral" rel="Chapter" href="Ephemeral.html">
<link title="Fsync" rel="Chapter" href="Fsync.html">
<link title="LevelDb" rel="Chapter" href="LevelDb.html">
<link title="MoreLevelDb" rel="Chapter" href="MoreLevelDb.html">
<link title="HelloServer" rel="Chapter" href="HelloServer.html">
<link title="HelloGetServer" rel="Chapter" href="HelloGetServer.html">
<link title="HelloHtmlServer" rel="Chapter" href="HelloHtmlServer.html"><title>HandCard</title>
</head>
<body>
<code class="code"><span class="keyword">open</span>&nbsp;<span class="constructor">Core</span>.<span class="constructor">Std</span><br>
<span class="keyword">open</span>&nbsp;<span class="constructor">Async</span>.<span class="constructor">Std</span><br>
<br>
<span class="keyword">type</span>&nbsp;suit&nbsp;=<br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Spades</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Hearts</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Diamonds</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Clubs</span><br>
<br>
<span class="keyword">type</span>&nbsp;rank&nbsp;=<br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">One</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Two</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Three</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Four</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Five</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Six</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Seven</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Eight</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Nine</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Ten</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Jack</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Queen</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">King</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Ace</span><br>
<br>
<span class="keyword">type</span>&nbsp;card&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;suit:&nbsp;suit;<br>
&nbsp;&nbsp;rank:&nbsp;rank;<br>
}<br>
<br>
<span class="keyword">let</span>&nbsp;string_of_suit&nbsp;(suit:&nbsp;suit)&nbsp;:&nbsp;string&nbsp;=<br>
&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;suit&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Spades</span>&nbsp;&nbsp;&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="string">"Spades"</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Hearts</span>&nbsp;&nbsp;&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="string">"Hearts"</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Diamonds</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="string">"Diamonds"</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Clubs</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="string">"Clubs"</span><br>
<br>
<span class="keyword">let</span>&nbsp;suit_of_string&nbsp;(s:&nbsp;string)&nbsp;:&nbsp;suit&nbsp;option&nbsp;=<br>
&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;s&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"Spades"</span>&nbsp;&nbsp;&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Some</span>&nbsp;<span class="constructor">Spades</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"Hearts"</span>&nbsp;&nbsp;&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Some</span>&nbsp;<span class="constructor">Hearts</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"Diamonds"</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Some</span>&nbsp;<span class="constructor">Diamonds</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"Clubs"</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Some</span>&nbsp;<span class="constructor">Clubs</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">None</span><br>
<br>
<span class="keyword">let</span>&nbsp;string_of_rank&nbsp;(rank:&nbsp;rank)&nbsp;:&nbsp;string&nbsp;=<br>
&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;rank&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">One</span>&nbsp;&nbsp;&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="string">"One"</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Two</span>&nbsp;&nbsp;&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="string">"Two"</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Three</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="string">"Three"</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Four</span>&nbsp;&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="string">"Four"</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Five</span>&nbsp;&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="string">"Five"</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Six</span>&nbsp;&nbsp;&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="string">"Six"</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Seven</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="string">"Seven"</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Eight</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="string">"Eight"</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Nine</span>&nbsp;&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="string">"Nine"</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Ten</span>&nbsp;&nbsp;&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="string">"Ten"</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Jack</span>&nbsp;&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="string">"Jack"</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Queen</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="string">"Queen"</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">King</span>&nbsp;&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="string">"King"</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Ace</span>&nbsp;&nbsp;&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="string">"Ace"</span><br>
<br>
<span class="keyword">let</span>&nbsp;rank_of_string&nbsp;(s:&nbsp;string)&nbsp;:&nbsp;rank&nbsp;option&nbsp;=<br>
&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;s&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"One"</span>&nbsp;&nbsp;&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Some</span>&nbsp;<span class="constructor">One</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"Two"</span>&nbsp;&nbsp;&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Some</span>&nbsp;<span class="constructor">Two</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"Three"</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Some</span>&nbsp;<span class="constructor">Three</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"Four"</span>&nbsp;&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Some</span>&nbsp;<span class="constructor">Four</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"Five"</span>&nbsp;&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Some</span>&nbsp;<span class="constructor">Five</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"Six"</span>&nbsp;&nbsp;&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Some</span>&nbsp;<span class="constructor">Six</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"Seven"</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Some</span>&nbsp;<span class="constructor">Seven</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"Eight"</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Some</span>&nbsp;<span class="constructor">Eight</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"Nine"</span>&nbsp;&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Some</span>&nbsp;<span class="constructor">Nine</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"Ten"</span>&nbsp;&nbsp;&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Some</span>&nbsp;<span class="constructor">Ten</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"Jack"</span>&nbsp;&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Some</span>&nbsp;<span class="constructor">Jack</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"Queen"</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Some</span>&nbsp;<span class="constructor">Queen</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"King"</span>&nbsp;&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Some</span>&nbsp;<span class="constructor">King</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="string">"Ace"</span>&nbsp;&nbsp;&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">Some</span>&nbsp;<span class="constructor">Ace</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">None</span><br>
<br>
<span class="keyword">let</span>&nbsp;string_of_card&nbsp;(card:&nbsp;card)&nbsp;:&nbsp;string&nbsp;=<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;{suit;&nbsp;rank}&nbsp;=&nbsp;card&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;(string_of_suit&nbsp;suit)&nbsp;^&nbsp;<span class="string">"&nbsp;"</span>&nbsp;^&nbsp;(string_of_rank&nbsp;rank)<br>
<br>
<span class="keyword">let</span>&nbsp;card_of_string&nbsp;(s:&nbsp;string)&nbsp;:&nbsp;card&nbsp;option&nbsp;=<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;(&gt;&gt;=)&nbsp;o&nbsp;f&nbsp;=<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;o&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Some</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;f&nbsp;x<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">None</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">None</span><br>
&nbsp;&nbsp;<span class="keyword">in</span><br>
<br>
&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;<span class="constructor">String</span>.split&nbsp;s&nbsp;~on:<span class="string">'&nbsp;'</span>&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;[suit;&nbsp;rank]&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;suit_of_string&nbsp;suit&nbsp;&gt;&gt;=&nbsp;<span class="keyword">fun</span>&nbsp;suit&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;rank_of_string&nbsp;rank&nbsp;&gt;&gt;=&nbsp;<span class="keyword">fun</span>&nbsp;rank&nbsp;<span class="keywordsign">-&gt;</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Some</span>&nbsp;{suit;&nbsp;rank}<br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="constructor">None</span><br>
<br>
<span class="keyword">let</span>&nbsp;main&nbsp;()&nbsp;:&nbsp;unit&nbsp;<span class="constructor">Deferred</span>.t&nbsp;=<br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;card&nbsp;=&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;suit&nbsp;=&nbsp;<span class="constructor">Spades</span>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;rank&nbsp;=&nbsp;<span class="constructor">Ace</span>;<br>
&nbsp;&nbsp;}&nbsp;<span class="keyword">in</span><br>
<br>
&nbsp;&nbsp;<span class="comment">(*&nbsp;card&nbsp;-&gt;&nbsp;string&nbsp;*)</span><br>
&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;s&nbsp;=&nbsp;string_of_card&nbsp;card&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;print_endline&nbsp;s;<br>
<br>
&nbsp;&nbsp;<span class="comment">(*&nbsp;card&nbsp;-&gt;&nbsp;string&nbsp;-&gt;&nbsp;card&nbsp;*)</span><br>
&nbsp;&nbsp;(<span class="keyword">match</span>&nbsp;card_of_string&nbsp;s&nbsp;<span class="keyword">with</span><br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Some</span>&nbsp;card'&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;print_endline&nbsp;(string_of_card&nbsp;card')<br>
&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">None</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;failwith&nbsp;<span class="string">"impossible"</span>);<br>
<br>
&nbsp;&nbsp;return&nbsp;()<br>
<br>
<span class="keyword">let</span>&nbsp;()&nbsp;=<br>
&nbsp;&nbsp;<span class="constructor">Command</span>.(run&nbsp;(async&nbsp;~summary:<span class="string">""</span>&nbsp;<span class="constructor">Spec</span>.empty&nbsp;main))<br>
</code></body></html>
<html><head>
<link rel="stylesheet" href="style.css" type="text/css">
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type">
<link rel="Start" href="index.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="HelloWrong" rel="Chapter" href="HelloWrong.html">
<link title="HelloRight" rel="Chapter" href="HelloRight.html">
<link title="HelloCommand" rel="Chapter" href="HelloCommand.html">
<link title="Basics" rel="Chapter" href="Basics.html">
<link title="Choices" rel="Chapter" href="Choices.html">
<link title="Pipes" rel="Chapter" href="Pipes.html">
<link title="Ivars" rel="Chapter" href="Ivars.html">
<link title="MoreChoices" rel="Chapter" href="MoreChoices.html">
<link title="MorePipes" rel="Chapter" href="MorePipes.html">
<link title="StdinLine" rel="Chapter" href="StdinLine.html">
<link title="StdoutLine" rel="Chapter" href="StdoutLine.html">
<link title="StdinAll" rel="Chapter" href="StdinAll.html">
<link title="WriteString" rel="Chapter" href="WriteString.html">
<link title="WriteLine" rel="Chapter" href="WriteLine.html">
<link title="WriteWith" rel="Chapter" href="WriteWith.html">
<link title="Diary" rel="Chapter" href="Diary.html">
<link title="Cat" rel="Chapter" href="Cat.html">
<link title="PrintServer" rel="Chapter" href="PrintServer.html">
<link title="EchoOnceServer" rel="Chapter" href="EchoOnceServer.html">
<link title="EchoServer" rel="Chapter" href="EchoServer.html">
<link title="ExitEchoServer" rel="Chapter" href="ExitEchoServer.html">
<link title="PrintClient" rel="Chapter" href="PrintClient.html">
<link title="EchoClient" rel="Chapter" href="EchoClient.html">
<link title="TcpShell" rel="Chapter" href="TcpShell.html">
<link title="KeyValueStore" rel="Chapter" href="KeyValueStore.html">
<link title="RedisOp" rel="Chapter" href="RedisOp.html">
<link title="Redis" rel="Chapter" href="Redis.html">
<link title="HandCard" rel="Chapter" href="HandCard.html">
<link title="SexpCard" rel="Chapter" href="SexpCard.html">
<link title="MarshalCard" rel="Chapter" href="MarshalCard.html">
<link title="BinioCard" rel="Chapter" href="BinioCard.html">
<link title="ArithMarshal" rel="Chapter" href="ArithMarshal.html">
<link title="MarshalClient" rel="Chapter" href="MarshalClient.html">
<link title="MarshalServer" rel="Chapter" href="MarshalServer.html">
<link title="ArithSexp" rel="Chapter" href="ArithSexp.html">
<link title="SexpClient" rel="Chapter" href="SexpClient.html">
<link title="SexpServer" rel="Chapter" href="SexpServer.html">
<link title="ToStringProtocol" rel="Chapter" href="ToStringProtocol.html">
<link title="ToStringClient" rel="Chapter" href="ToStringClient.html">
<link title="ToStringServer" rel="Chapter" href="ToStringServer.html">
<link title="ArithRpc" rel="Chapter" href="ArithRpc.html">
<link title="RpcClient" rel="Chapter" href="RpcClient.html">
<link title="RpcServer" rel="Chapter" href="RpcServer.html">
<link title="Ephemeral" rel="Chapter" href="Ephemeral.html">
<link title="Fsync" rel="Chapter" href="Fsync.html">
<link title="LevelDb" rel="Chapter" href="LevelDb.html">
<link title="MoreLevelDb" rel="Chapter" href="MoreLevelDb.html">
<link title="HelloServer" rel="Chapter" href="HelloServer.html">
<link title="HelloGetServer" rel="Chapter" href="HelloGetServer.html">
<link title="HelloHtmlServer" rel="Chapter" href="HelloHtmlServer.html"><title>HelloWrong</title>
</head>
<body>
<code class="code"><span class="comment">(*&nbsp;To&nbsp;start&nbsp;our&nbsp;journey&nbsp;of&nbsp;learning&nbsp;async,&nbsp;let's&nbsp;write&nbsp;a&nbsp;very&nbsp;simple&nbsp;hello<br>
&nbsp;*&nbsp;world&nbsp;program!&nbsp;Since&nbsp;we're&nbsp;going&nbsp;to&nbsp;use&nbsp;code&nbsp;from&nbsp;the&nbsp;Core&nbsp;and&nbsp;Async<br>
&nbsp;*&nbsp;libraries,&nbsp;we'll&nbsp;open&nbsp;Core.Std&nbsp;and&nbsp;Async.Std.&nbsp;This&nbsp;is&nbsp;a&nbsp;very&nbsp;typical&nbsp;thing<br>
&nbsp;*&nbsp;to&nbsp;do&nbsp;and&nbsp;will&nbsp;appear&nbsp;in&nbsp;most&nbsp;or&nbsp;all&nbsp;of&nbsp;the&nbsp;files&nbsp;we're&nbsp;going&nbsp;to&nbsp;see.&nbsp;*)</span><br>
<span class="keyword">open</span>&nbsp;<span class="constructor">Core</span>.<span class="constructor">Std</span><br>
<span class="keyword">open</span>&nbsp;<span class="constructor">Async</span>.<span class="constructor">Std</span><br>
<br>
<span class="comment">(*&nbsp;Next,&nbsp;we'll&nbsp;write&nbsp;a&nbsp;main&nbsp;function&nbsp;that&nbsp;prints&nbsp;"hello&nbsp;world!".&nbsp;Pretty&nbsp;simple,<br>
&nbsp;*&nbsp;right?&nbsp;Now&nbsp;in&nbsp;OCaml,&nbsp;we&nbsp;don't&nbsp;really&nbsp;*need*&nbsp;to&nbsp;write&nbsp;a&nbsp;function&nbsp;named&nbsp;main.<br>
&nbsp;*&nbsp;When&nbsp;we&nbsp;compile&nbsp;and&nbsp;run&nbsp;programs,&nbsp;all&nbsp;top-level&nbsp;code&nbsp;will&nbsp;be&nbsp;executed,&nbsp;so<br>
&nbsp;*&nbsp;there's&nbsp;nothing&nbsp;special&nbsp;about&nbsp;this&nbsp;function&nbsp;being&nbsp;named&nbsp;main.&nbsp;We&nbsp;could&nbsp;have<br>
&nbsp;*&nbsp;named&nbsp;it&nbsp;foo&nbsp;or&nbsp;bar&nbsp;and&nbsp;the&nbsp;code&nbsp;would&nbsp;act&nbsp;just&nbsp;the&nbsp;same.&nbsp;But&nbsp;for&nbsp;the&nbsp;sake<br>
&nbsp;*&nbsp;of&nbsp;clarity,&nbsp;we'll&nbsp;typically&nbsp;create&nbsp;a&nbsp;function&nbsp;named&nbsp;main&nbsp;anyway.&nbsp;*)</span><br>
<span class="keyword">let</span>&nbsp;main&nbsp;()&nbsp;:&nbsp;unit&nbsp;=<br>
&nbsp;&nbsp;print_endline&nbsp;<span class="string">"hello&nbsp;world!"</span><br>
<br>
<span class="comment">(*&nbsp;Now,&nbsp;we&nbsp;run&nbsp;main!&nbsp;If&nbsp;you&nbsp;run&nbsp;this&nbsp;code,&nbsp;though,&nbsp;you'll&nbsp;notice&nbsp;something<br>
&nbsp;*&nbsp;strange!&nbsp;Namely,&nbsp;it&nbsp;doesn't&nbsp;print&nbsp;"hello&nbsp;world!".&nbsp;Hm,&nbsp;why&nbsp;doesn't&nbsp;our&nbsp;hello<br>
&nbsp;*&nbsp;world&nbsp;program&nbsp;print&nbsp;"hello&nbsp;world"!?&nbsp;Well,&nbsp;the&nbsp;real&nbsp;reason&nbsp;is&nbsp;a&nbsp;bit<br>
&nbsp;*&nbsp;complicated.&nbsp;When&nbsp;we&nbsp;opened&nbsp;Async.Std,&nbsp;we&nbsp;shadowed&nbsp;the&nbsp;definition&nbsp;of<br>
&nbsp;*&nbsp;print_endline&nbsp;found&nbsp;in&nbsp;the&nbsp;standard&nbsp;library&nbsp;with&nbsp;the&nbsp;async&nbsp;definition&nbsp;of<br>
&nbsp;*&nbsp;print_endline.&nbsp;Whenever&nbsp;we&nbsp;deal&nbsp;with&nbsp;async&nbsp;code,&nbsp;we&nbsp;need&nbsp;to&nbsp;make&nbsp;sure&nbsp;to<br>
&nbsp;*&nbsp;start&nbsp;the&nbsp;scheduler!&nbsp;Otherwise,&nbsp;nothing&nbsp;runs&nbsp;like&nbsp;we&nbsp;expect.&nbsp;Long&nbsp;story<br>
&nbsp;*&nbsp;short,&nbsp;don't&nbsp;forget&nbsp;to&nbsp;start&nbsp;the&nbsp;async&nbsp;scheduler!&nbsp;*)</span><br>
<span class="keyword">let</span>&nbsp;()&nbsp;=<br>
&nbsp;&nbsp;main&nbsp;()<br>
</code></body></html>